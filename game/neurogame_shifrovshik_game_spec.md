# üéÆ –ù–µ–π—Ä–æ–∏–≥—Ä–∞ ¬´–®–∏—Ñ—Ä–æ–≤—â–∏–∫¬ª
## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ (game/)

---

## 1. –û–±—â–∞—è –∏–¥–µ—è –∏–≥—Ä—ã

**¬´–®–∏—Ñ—Ä–æ–≤—â–∏–∫¬ª** ‚Äî –Ω–µ–π—Ä–æ–∏–≥—Ä–∞, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É **–∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ–π –≥–∏–±–∫–æ—Å—Ç–∏ –∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∑–∞–¥–∞—á (task switching)**.

–ò–≥—Ä–æ–∫ –≤—ã—Å—Ç—É–ø–∞–µ—Ç –≤ —Ä–æ–ª–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ —É–∑–ª–∞ —Å–≤—è–∑–∏ –∏ –¥–æ–ª–∂–µ–Ω –±—ã—Å—Ç—Ä–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–µ —Å–∏–≥–Ω–∞–ª—ã, –ø—Ä–∏–º–µ–Ω—è—è **—Ä–∞–∑–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–µ—à–∏—Ñ—Ä–æ–≤–∫–∏**, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è –æ—Ç –ø–æ–ø—ã—Ç–∫–∏ –∫ –ø–æ–ø—ã—Ç–∫–µ.

–ö–ª—é—á–µ–≤–∞—è –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞ —Å—á—ë—Ç:
- —á–∞—Å—Ç—ã—Ö –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞;
- –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–¥–∞–≤–ª—è—Ç—å –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å—Ç–∏–º—É–ª–∞;
- –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Ä–µ–∞–∫—Ü–∏–∏.

---

## 2. –ò–≥—Ä–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ (Task Switching)

### 2.1 –°—Ç–∏–º—É–ª

–ö–∞–∂–¥—ã–π –≤—Ö–æ–¥—è—â–∏–π —Å–∏–≥–Ω–∞–ª –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ –≤–∏–¥–µ **—Å—Ç–∏–º—É–ª–∞**, –æ–±–ª–∞–¥–∞—é—â–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏:

- —Ü–≤–µ—Ç —Ä–∞–º–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `red`, `green`, `blue`, `yellow`);
- —Ñ–æ—Ä–º–∞ —Å–∏–º–≤–æ–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `circle`, `triangle`, `square`, `cross`);
- –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º: –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è, —Ñ–æ–Ω, –≤–∏–∑—É–∞–ª—å–Ω—ã–π —à—É–º –∏ –¥—Ä.

–í —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ trial –∏–≥—Ä–æ–∫—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å **–æ–¥–Ω–æ –∏–∑ —á–µ—Ç—ã—Ä—ë—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π** (–∫–ª–∞–≤–∏—à–∏ `F / J / K / L`).

---

### 2.2 –ó–∞–¥–∞—á–∏ (Tasks)

–ó–∞–¥–∞—á–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, **–∫–∞–∫–æ–π –ø—Ä–∏–∑–Ω–∞–∫ —Å—Ç–∏–º—É–ª–∞ —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–º** –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞.

#### Task A ‚Äî –¶–≤–µ—Ç–æ–≤–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª

–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è **—Ü–≤–µ—Ç–æ–º —Ä–∞–º–∫–∏**.

```
red    ‚Üí F
green  ‚Üí J
blue   ‚Üí K
yellow ‚Üí L
```

#### Task B ‚Äî –°–∏–º–≤–æ–ª—å–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª

–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è **—Ñ–æ—Ä–º–æ–π —Å–∏–º–≤–æ–ª–∞**.

```
circle   ‚Üí F
triangle ‚Üí J
square   ‚Üí K
cross    ‚Üí L
```

#### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

- **Task C** ‚Äî –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è / –ø–æ–≤–æ—Ä–æ—Ç —Å–∏–º–≤–æ–ª–∞);
- **Task D** ‚Äî –ø—Ä–æ—Ç–æ–∫–æ–ª —Å –ø–æ–º–µ—Ö–∞–º–∏ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫).

---

### 2.3 Cue (–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ–π –∑–∞–¥–∞—á–∏)

–ü–µ—Ä–µ–¥ –ø—Ä–µ–¥—ä—è–≤–ª–µ–Ω–∏–µ–º —Å—Ç–∏–º—É–ª–∞ –∏–≥—Ä–æ–∫—É –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è **–≤–∏–∑—É–∞–ª—å–Ω—ã–π cue**, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π —Ç–µ–∫—É—â—É—é –∑–∞–¥–∞—á—É:

- —Ç–µ–∫—Å—Ç–æ–≤—ã–π (`COLOR`, `SHAPE`);
- –∏–∫–æ–Ω–∫–∞ –∏–ª–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–µ–∂–∏–º–∞;
- cue –º–æ–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥ —Å—Ç–∏–º—É–ª–æ–º –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ.

Cue —è–≤–ª—è–µ—Ç—Å—è **–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏** –æ —Ç–æ–º, –∫–∞–∫–æ–µ –ø—Ä–∞–≤–∏–ª–æ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å.

---

## 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–ø–∫–∏ `game/`

–ü–∞–ø–∫–∞ `game/` –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ **–∏–≥—Ä–æ–≤—É—é –ª–æ–≥–∏–∫—É –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**, –Ω–æ –Ω–µ –∑–∞ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–µ –∑–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏—é —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.

### –û–±—â–∏–π –∏–≥—Ä–æ–≤–æ–π –ø–æ—Ç–æ–∫

```
BlockParams + seed
        ‚Üì
trial_generator ‚Üí list[TrialSpec]
        ‚Üì
scene –∑–∞–ø—É—Å–∫–∞–µ—Ç trials
        ‚Üì
state_machine —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–∑–∞–º–∏
        ‚Üì
renderer –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç
        ‚Üì
input ‚Üí Action
        ‚Üì
TrialEvent ‚Üí –Ω–∞—Ä—É–∂—É (main / logger)
```

---

## 4. –û–±—â–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

–°–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã **–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤–Ω–µ –ø–∞–ø–∫–∏ `game/`** (–≤ `data/models.py`) –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é:

- `TrialSpec` ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ trial;
- `TrialEvent` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è trial;
- `BlockParams` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–ª–æ–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.

–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç—Ç–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –≤ `game/` –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è.

---

## 5. `game/trial_generator.py`

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ trial-–æ–≤ –¥–ª—è –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞ —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –±–∞–ª–∞–Ω—Å–∞.

### –ü—É–±–ª–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è

```python
generate_block(
    params: BlockParams,
    seed: int,
    block_id: int
) -> list[TrialSpec]
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

- –¥–ª–∏–Ω–∞ –±–ª–æ–∫–∞: `params.n_trials`;
- –¥–æ–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π –∑–∞–¥–∞—á: `params.switch_rate`;
- –±–∞–ª–∞–Ω—Å –∑–∞–¥–∞—á (A / B);
- –±–∞–ª–∞–Ω—Å —Å—Ç–∏–º—É–ª–æ–≤;
- (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –∫–æ–Ω—Ç—Ä–æ–ª—å congruent / incongruent trial-–æ–≤.

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `random.Random(seed)`;
2. –°–ª—É—á–∞–π–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω—É—é –∑–∞–¥–∞—á—É –∏–∑ `params.tasks_enabled`;
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ trial:
   - —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é `switch_rate` —Å–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É;
   - –∏–Ω–∞—á–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â—É—é;
4. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∏–º—É–ª —á–µ—Ä–µ–∑ `tasks.py`;
5. –í—ã—á–∏—Å–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç —á–µ—Ä–µ–∑ `tasks.py`.

### –ì–∞—Ä–∞–Ω—Ç–∏–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏

- `trial_index` —Å—Ç—Ä–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç;
- –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã:
  - `task_id`;
  - `is_switch`;
  - `correct_action`.

### –í–∞–ª–∏–¥–∞—Ü–∏—è

- –µ—Å–ª–∏ `len(tasks_enabled) < 2` –∏ `switch_rate > 0`,
  - –ª–∏–±–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `switch_rate = 0`,
  - –ª–∏–±–æ –≤—ã–±—Ä–æ—Å–∏—Ç—å –æ—Å–º—ã—Å–ª–µ–Ω–Ω—É—é –æ—à–∏–±–∫—É.

---

## 6. `game/tasks.py`

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:
- –∑–∞–¥–∞—á;
- —Å—Ç–∏–º—É–ª–æ–≤;
- –ø—Ä–∞–≤–∏–ª –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

#### `TaskId` (Enum)

```python
COLOR
SHAPE
```

#### `Stimulus` (dataclass)

```python
color: str
shape: str
stimulus_id: str
```

#### `Action`

–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –∏–ª–∏ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–∑ 4 –≤–æ–∑–º–æ–∂–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `F / J / K / L`).

### –ü—É–±–ª–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

```python
sample_stimulus(rng: random.Random, params: BlockParams) -> Stimulus
```

```python
get_correct_action(task_id: TaskId, stimulus: Stimulus, mapping: dict) -> Action
```

```python
build_default_mapping() -> dict
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- –≤—Å—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∞–≤–∏–ª –∑–∞–¥–∞—á –Ω–∞—Ö–æ–¥–∏—Ç—Å—è **—Ç–æ–ª—å–∫–æ –∑–¥–µ—Å—å**;
- –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ü–µ–Ω–∞ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∑–Ω–∞–Ω–∏–π –æ —Ç–æ–º, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º.

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
1. —Ä–∞—Å—à–∏—Ä–∏—Ç—å `TaskId`;
2. –¥–æ–ø–æ–ª–Ω–∏—Ç—å `get_correct_action`;
3. –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ mapping.

---

## 7. `game/input.py`

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞: –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π `pygame` –≤ –∏–≥—Ä–æ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (`Action`).

### –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª–∞—Å—Å

```python
InputManager
```

#### –ú–µ—Ç–æ–¥—ã

```python
process_pygame_event(event)
poll_action() -> Action | None
reset()
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è `KEYDOWN`;
- –æ–¥–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ –æ–¥–∏–Ω trial (–±–µ–∑ –∑–∞–ª–∏–ø–∞–Ω–∏—è);
- –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ª–µ–≥–∫–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞—Å–∫–ª–∞–¥–∫—É –∫–ª–∞–≤–∏—à;
- –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø–æ–¥–¥–µ—Ä–∂–∫–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤–≤–æ–¥–∞.

---

## 8. `game/renderer.py`

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–û—Ç–≤–µ—á–∞–µ—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –∑–∞ **–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é** —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã.

### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```python
Renderer(screen, assets, config)
```

### –ú–µ—Ç–æ–¥—ã

- `draw_cue(task_id, time_left_ms=None)`;
- `draw_stimulus(stimulus)`;
- `draw_feedback(is_correct, message=None)`;
- `draw_hud(block_progress, score, integrity=None)`;
- `clear()`;
- `present()`.

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π MVP

- cue: —Ç–µ–∫—Å—Ç `COLOR` / `SHAPE`;
- stimulus: —Ü–≤–µ—Ç–Ω–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è —Ñ–∏–≥—É—Ä–∞;
- feedback: `Correct` / `Incorrect` (0.2‚Äì0.4 —Å–µ–∫);
- HUD: –Ω–æ–º–µ—Ä trial-–∞ –∏ —Å—á—ë—Ç.

---

## 9. `game/state_machine.py`

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–Ø–≤–Ω–∞—è –∫–æ–Ω–µ—á–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∞, —É–ø—Ä–∞–≤–ª—è—é—â–∞—è —Ñ–∞–∑–∞–º–∏ –æ–¥–Ω–æ–≥–æ trial-–∞.

### –°–æ—Å—Ç–æ—è–Ω–∏—è (`Phase`)

```python
SHOW_CUE
SHOW_STIMULUS
WAIT_RESPONSE
SHOW_FEEDBACK
ITI
```

### Runtime-–¥–∞–Ω–Ω—ã–µ

```python
phase_started_at_ms
current_trial
response_action
rt_ms
is_timeout
```

### –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª–∞—Å—Å

```python
TrialStateMachine(timing: TimingConfig)
```

### –ú–µ—Ç–æ–¥—ã

```python
start_trial(trial, now_ms)
update(now_ms, action) -> (finished, TrialEvent | None)
get_phase()
get_time_left()
```

### –ü—Ä–∞–≤–∏–ª–∞

- –≤—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏ —Å—á–∏—Ç–∞–µ—Ç—Å—è —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è —Å—Ç–∏–º—É–ª–∞;
- –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ `timeout`;
- —Ñ–∞–∑–∞ feedback –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

---

## 10. `game/scene.py`

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞ –∏–≥—Ä—ã: –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä, –∞–≤—Ç–æ–º–∞—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–π, —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∏ –≤–≤–æ–¥.

### –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª–∞—Å—Å

```python
GameScene
```

### –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

–ü—Ä–∏–Ω–∏–º–∞–µ—Ç:
- `screen`;
- `renderer`;
- `input_manager`;
- `block_params`;
- `seed`;
- `block_id`;
- callback `on_trial_event(event)`.

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –ü—Ä–∏ `start()`:
   - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –±–ª–æ–∫ trial-–æ–≤;
   - –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π trial;
2. –ù–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ:
   - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤–≤–æ–¥;
   - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è `state_machine`;
   - –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ trial-–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è `TrialEvent`;
   - –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–π —Ñ–∞–∑—ã;
3. –ë–ª–æ–∫ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –≤—Å–µ trial-—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã.

---

## 11. –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ `game/`

–ü–æ—Å–ª–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

- –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è `main.py`;
- –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–∏–Ω –±–ª–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 40 trial-–æ–≤);
- —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ `TrialEvent`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π:
  - –≤—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏;
  - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞;
  - —Ñ–ª–∞–≥–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∑–∞–¥–∞—á.

–î–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —è–≤–ª—è–µ—Ç—Å—è –≥–æ—Ç–æ–≤–æ–π –æ—Å–Ω–æ–≤–æ–π –¥–ª—è:
- –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö;
- –∞–Ω–∞–ª–∏—Ç–∏–∫–∏;
- –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é.

